var __extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)},Blackthorn;!function(t){function e(){for(var t=Array(36),e="0123456789abcdef",i=0;i<36;i++)t[i]=e.substr(Math.floor(16*Math.random()),1);t[14]="4",t[19]=e.substr(3&parseInt(t[19],16)|8,1),t[8]=t[13]=t[18]=t[23]="-";var n=t.join("");return n}var i=function(){function t(t,e,i){this.tree=e,this.blackboard=i,this.ticker=new o(t,i,e)}return t.prototype.tick=function(){this.tree.tick(this,this.blackboard,this.ticker)},t}();t.Agent=i;var n=function(t){function e(e,i){t.call(this,e,i,new r)}return __extends(e,t),e}(i);t.DedicatedAgent=n;var r=function(){function t(){this._baseMemory={},this._treeMemory={}}return t.prototype._getTreeMemory=function(t){return this._treeMemory[t]||(this._treeMemory[t]={nodeMemory:{},openNodes:[]}),this._treeMemory[t]},t.prototype._getNodeMemory=function(t,e){var i=t.nodeMemory;return i[e]||(i[e]={}),i[e]},t.prototype._getMemory=function(t,e){var i=this._baseMemory;return t&&(i=this._getTreeMemory(t),e&&(i=this._getNodeMemory(i,e))),i},t.prototype.set=function(t,e,i,n){var r=this._getMemory(i,n);r[t]=e},t.prototype.get=function(t,e,i){var n=this._getMemory(e,i);return n[t]},t}();t.Blackboard=r;var o=function(){function t(t,e,i){this.tree=i,this.openNodes=[],this.nodeCount=0,this.debug=null,this.subject=t,this.blackboard=e}return t.prototype.enterNode=function(t){this.nodeCount++,this.openNodes.push(t)},t.prototype.openNode=function(t){},t.prototype.tickNode=function(t){},t.prototype.closeNode=function(t){this.openNodes.pop()},t.prototype.exitNode=function(t){},t}();t.Ticker=o;var c=function(){function t(t){this.id=e(),this.root=t}return t.prototype.tick=function(t,e,i){i?i.openNodes=[]:i=new o(t,e,this),this.root._execute(i);for(var n=e.get("openNodes",this.id),r=i.openNodes,c=0,s=0;s<Math.min(n.length,r.length)&&(c=s+1,n[s]===r[s]);s++);for(var s=n.length-1;s>=c;s--)n[s]._close(i);e.set("openNodes",r,this.id),e.set("nodeCount",i.nodeCount,this.id)},t}();t.BehaviorTree=c;var s=function(){function t(t){if(this.id=e(),this.children=[],t)for(var i=0;i<t.length;i++)this.children.push(t[i])}return t.prototype._execute=function(t){this._enter(t),t.blackboard.get("isOpen",t.tree.id,this.id)||this._open(t);var e=this._tick(t);return 2!==e&&this._close(t),this._exit(t),e},t.prototype._enter=function(t){t.enterNode(this),this.enter(t)},t.prototype._open=function(t){t.openNode(this),t.blackboard.set("isOpen",!0,t.tree.id,this.id),this.open(t)},t.prototype._tick=function(t){return t.tickNode(this),this.tick(t)},t.prototype._close=function(t){t.closeNode(this),t.blackboard.set("isOpen",!1,t.tree.id,this.id),this.close(t)},t.prototype._exit=function(t){t.exitNode(this),this.exit(t)},t.prototype.enter=function(t){},t.prototype.open=function(t){},t.prototype.close=function(t){},t.prototype.exit=function(t){},t}();t.BaseNode=s;var u=function(t){function e(){t.call(this)}return __extends(e,t),e}(s);t.Action=u;var h=function(t){function e(){for(var e=[],i=0;i<arguments.length;i++)e[i-0]=arguments[i];t.call(this,e)}return __extends(e,t),e}(s);t.Composite=h;var a=function(t){function e(e){t.call(this,[e])}return __extends(e,t),e}(s);t.Decorator=a;var p=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e}(u);t.Condition=p;var d=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.tick=function(t){for(var e=0;e<this.children.length;e++){var i=this.children[e]._execute(t);if(1!==i)return i}return 1},e}(h);t.Sequence=d;var l=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.tick=function(t){for(var e=0;e<this.children.length;e++){var i=this.children[e]._execute(t);if(0!==i)return i}return 0},e}(h);t.Selector=l;var f=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this,e),e.blackboard.set("runningChild",0,e.tree.id,this.id)},e.prototype.tick=function(t){for(var e=t.blackboard.get("runningChild",t.tree.id,this.id),i=e;i<this.children.length;i++){var n=this.children[i]._execute(t);if(1!==n)return 2===n&&t.blackboard.set("runningChild",i,t.tree.id,this.id),n}return 1},e}(h);t.MemSequence=f;var _=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this,e),e.blackboard.set("runningChild",0,e.tree.id,this.id)},e.prototype.tick=function(t){for(var e=t.blackboard.get("runningChild",t.tree.id,this.id),i=e;i<this.children.length;i++){var n=this.children[i]._execute(t);if(0!==n)return 2===n&&t.blackboard.set("runningChild",i,t.tree.id,this.id),n}return 0},e}(h);t.MemSelector=_;var y=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.tick=function(t){var e=Math.random()*this.children.length|0,i=this.children[e],n=i._execute(t);return n},e}(h);t.RandomSelector=y;var k=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.tick=function(t){if(1!==this.children.length)return 3;var e=this.children[0],i=e._execute(t);return 1===i?i=0:0===i&&(i=1),i},e}(a);t.Inverter=k;var v=function(t){function e(e,i){t.call(this,i),this.maxTime=e}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this,e);var i=(new Date).getTime();e.blackboard.set("startTime",i,e.tree.id,this.id)},e.prototype.tick=function(t){if(1!==this.children.length)return 3;var e=this.children[0],i=(new Date).getTime(),n=t.blackboard.get("startTime",t.tree.id,this.id);return i-n>this.maxTime?0:e._execute(t)},e}(a);t.LimiterTime=v;var x=function(t){function e(e,i){t.call(this,i),this.maxTicks=e,this.elapsedTicks=0}return __extends(e,t),e.prototype.open=function(e){t.prototype.open.call(this,e),this.elapsedTicks=0},e.prototype.tick=function(t){if(1!==this.children.length)return 3;var e=this.children[0];return++this.elapsedTicks>this.maxTicks?(this.elapsedTicks=0,0):e._execute(t)},e}(a);t.LimiterTicks=x;var b=function(t){function e(e,i){void 0===i&&(i=-1),t.call(this,e),this.maxLoop=i}return __extends(e,t),e.prototype.open=function(t){t.blackboard.set("i",0,t.tree.id,this.id)},e.prototype.tick=function(t){if(1!==this.children.length)return 3;for(var e=this.children[0],i=t.blackboard.get("i",t.tree.id,this.id),n=1;(this.maxLoop<0||i<this.maxLoop)&&(n=e._execute(t),1===n||0===n);)i++;return t.blackboard.set("i",i,t.tree.id,this.id),n},e}(a);t.Repeater=b;var g=function(t){function e(e,i){void 0===i&&(i=-1),t.call(this,e),this.maxLoop=i}return __extends(e,t),e.prototype.open=function(t){t.blackboard.set("i",0,t.tree.id,this.id)},e.prototype.tick=function(t){if(1!==this.children.length)return 3;for(var e=this.children[0],i=t.blackboard.get("i",t.tree.id,this.id),n=1;(this.maxLoop<0||i<this.maxLoop)&&(n=e._execute(t),1===n);)i++;return t.blackboard.set("i",i,t.tree.id,this.id),n},e}(a);t.RepeatUntilFailure=g;var m=function(t){function e(e,i){void 0===i&&(i=-1),t.call(this,e),this.maxLoop=i}return __extends(e,t),e.prototype.open=function(t){t.blackboard.set("i",0,t.tree.id,this.id)},e.prototype.tick=function(t){if(1!==this.children.length)return 3;for(var e=this.children[0],i=t.blackboard.get("i",t.tree.id,this.id),n=0;(this.maxLoop<0||i<this.maxLoop)&&(n=e._execute(t),0===n);)i++;return t.blackboard.set("i",i,t.tree.id,this.id),n},e}(a);t.RepeatUntilSuccess=m;var T=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.tick=function(t){if(1!==this.children.length)return 3;var e=this.children[0];return e._execute(t),0},e}(a);t.Failer=T;var M=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.tick=function(t){if(1!==this.children.length)return 3;var e=this.children[0];return e._execute(t),2},e}(a);t.Runner=M;var N=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.tick=function(t){if(1!==this.children.length)return 3;var e=this.children[0];return e._execute(t),1},e}(a);t.Succeeder=N;var C=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.tick=function(t){return 3},e}(u);t.Error=C;var L=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.tick=function(t){return 0},e}(u);t.Failure=L;var w=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.tick=function(t){return 2},e}(u);t.Running=w;var S=function(t){function e(){t.apply(this,arguments)}return __extends(e,t),e.prototype.tick=function(t){return 1},e}(u);t.Success=S;var B=function(t){function e(e){void 0===e&&(e=0),t.call(this),this.duration=e}return __extends(e,t),e.prototype.open=function(t){var e=(new Date).getTime();t.blackboard.set("startTime",e,t.tree.id,this.id)},e.prototype.tick=function(t){var e=(new Date).getTime(),i=t.blackboard.get("startTime",t.tree.id,this.id);return e-i>=this.duration?1:2},e}(u);t.WaitTime=B;var D=function(t){function e(e){void 0===e&&(e=0),t.call(this),this.duration=e,this.elapsedTicks=0}return __extends(e,t),e.prototype.open=function(t){this.elapsedTicks=0},e.prototype.tick=function(t){return++this.elapsedTicks>=this.duration?(this.elapsedTicks=0,1):2},e}(u);t.WaitTicks=D}(Blackthorn||(Blackthorn={}));
//# sourceMappingURL=dist/blackthorn.min.js.map